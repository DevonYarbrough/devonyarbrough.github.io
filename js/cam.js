THREE.RenderableObject=function(){this.id=0,this.object=null,this.z=0,this.renderOrder=0},THREE.RenderableFace=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.normalModel=new THREE.Vector3,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsLength=0,this.color=new THREE.Color,this.material=null,this.uvs=[new THREE.Vector2,new THREE.Vector2,new THREE.Vector2],this.z=0,this.renderOrder=0},THREE.RenderableVertex=function(){this.position=new THREE.Vector3,this.positionWorld=new THREE.Vector3,this.positionScreen=new THREE.Vector4,this.visible=!0},THREE.RenderableVertex.prototype.copy=function(a){this.positionWorld.copy(a.positionWorld),this.positionScreen.copy(a.positionScreen)},THREE.RenderableLine=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.vertexColors=[new THREE.Color,new THREE.Color],this.material=null,this.z=0,this.renderOrder=0},THREE.RenderableSprite=function(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=0,this.scale=new THREE.Vector2,this.material=null,this.renderOrder=0},THREE.Projector=function(){function L(){if(b===d){var a=new THREE.RenderableObject;return c.push(a),d++,b++,a}return c[b++]}function M(){if(f===h){var a=new THREE.RenderableVertex;return g.push(a),h++,f++,a}return g[f++]}function N(){if(j===l){var a=new THREE.RenderableFace;return k.push(a),l++,j++,a}return k[j++]}function O(){if(n===p){var a=new THREE.RenderableLine;return o.push(a),p++,n++,a}return o[n++]}function P(){if(r===t){var a=new THREE.RenderableSprite;return s.push(a),t++,r++,a}return s[r++]}function Q(a,b){return a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.z!==b.z?b.z-a.z:a.id!==b.id?a.id-b.id:0}function R(a,b){var c=0,d=1,e=a.z+a.w,f=b.z+b.w,g=-a.z+a.w,h=-b.z+b.w;return e>=0&&f>=0&&g>=0&&h>=0||!(e<0&&f<0||g<0&&h<0)&&(e<0?c=Math.max(c,e/(e-f)):f<0&&(d=Math.min(d,e/(e-f))),g<0?c=Math.max(c,g/(g-h)):h<0&&(d=Math.min(d,g/(g-h))),!(d<c)&&(a.lerp(b,c),b.lerp(a,1-d),!0))}var a,b,e,f,i,j,m,n,q,r,D,c=[],d=0,g=[],h=0,k=[],l=0,o=[],p=0,s=[],t=0,u={objects:[],lights:[],elements:[]},v=new THREE.Vector3,w=new THREE.Vector4,x=new THREE.Box3(new THREE.Vector3((-1),(-1),(-1)),new THREE.Vector3(1,1,1)),y=new THREE.Box3,z=new Array(3),B=(new Array(4),new THREE.Matrix4),C=new THREE.Matrix4,E=new THREE.Matrix4,F=new THREE.Matrix3,G=new THREE.Frustum,H=new THREE.Vector4,I=new THREE.Vector4;this.projectVector=function(a,b){console.warn("THREE.Projector: .projectVector() is now vector.project()."),a.project(b)},this.unprojectVector=function(a,b){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),a.unproject(b)},this.pickingRay=function(a,b){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")};var J=function(){function h(e){c=e,d=c.material,f.getNormalMatrix(c.matrixWorld),a.length=0,b.length=0}function j(a){var b=a.position,c=a.positionWorld,d=a.positionScreen;c.copy(b).applyMatrix4(D),d.copy(c).applyMatrix4(C);var e=1/d.w;d.x*=e,d.y*=e,d.z*=e,a.visible=d.x>=-1&&d.x<=1&&d.y>=-1&&d.y<=1&&d.z>=-1&&d.z<=1}function k(a,b,c){e=M(),e.position.set(a,b,c),j(e)}function l(b,c,d){a.push(b,c,d)}function n(a,c){b.push(a,c)}function o(a,b,c){return a.visible===!0||b.visible===!0||c.visible===!0||(z[0]=a.positionScreen,z[1]=b.positionScreen,z[2]=c.positionScreen,x.intersectsBox(y.setFromPoints(z)))}function p(a,b,c){return(c.positionScreen.x-a.positionScreen.x)*(b.positionScreen.y-a.positionScreen.y)-(c.positionScreen.y-a.positionScreen.y)*(b.positionScreen.x-a.positionScreen.x)<0}function q(a,b){var d=g[a],e=g[b];m=O(),m.id=c.id,m.v1.copy(d),m.v2.copy(e),m.z=(d.positionScreen.z+e.positionScreen.z)/2,m.renderOrder=c.renderOrder,m.material=c.material,u.elements.push(m)}function r(e,h,j){var k=g[e],l=g[h],m=g[j];if(o(k,l,m)!==!1&&(d.side===THREE.DoubleSide||p(k,l,m)===!0)){i=N(),i.id=c.id,i.v1.copy(k),i.v2.copy(l),i.v3.copy(m),i.z=(k.positionScreen.z+l.positionScreen.z+m.positionScreen.z)/3,i.renderOrder=c.renderOrder,i.normalModel.fromArray(a,3*e),i.normalModel.applyMatrix3(f).normalize();for(var n=0;n<3;n++){var q=i.vertexNormalsModel[n];q.fromArray(a,3*arguments[n]),q.applyMatrix3(f).normalize();var r=i.uvs[n];r.fromArray(b,2*arguments[n])}i.vertexNormalsLength=3,i.material=c.material,u.elements.push(i)}}var a=[],b=[],c=null,d=null,f=new THREE.Matrix3;return{setObject:h,projectVertex:j,checkTriangleVisibility:o,checkBackfaceCulling:p,pushVertex:k,pushNormal:l,pushUv:n,pushLine:q,pushTriangle:r}},K=new J;this.projectScene=function(c,d,e,h){function k(b){a=L(),a.id=b.id,a.object=b,v.setFromMatrixPosition(b.matrixWorld),v.applyProjection(C),a.z=v.z,a.renderOrder=b.renderOrder,u.objects.push(a)}j=0,n=0,r=0,u.elements.length=0,c.autoUpdate===!0&&c.updateMatrixWorld(),null===d.parent&&d.updateMatrixWorld(),B.copy(d.matrixWorldInverse.getInverse(d.matrixWorld)),C.multiplyMatrices(d.projectionMatrix,B),G.setFromMatrix(C),b=0,u.objects.length=0,u.lights.length=0,c.traverseVisible(function(a){if(a instanceof THREE.Light)u.lights.push(a);else if(a instanceof THREE.Mesh||a instanceof THREE.Line){if(a.material.visible===!1)return;if(a.frustumCulled===!0&&G.intersectsObject(a)===!1)return;k(a)}else if(a instanceof THREE.Sprite){if(a.material.visible===!1)return;if(a.frustumCulled===!0&&G.intersectsSprite(a)===!1)return;k(a)}}),e===!0&&u.objects.sort(Q);for(var l=0,o=u.objects.length;l<o;l++){var p=u.objects[l].object,s=p.geometry;if(K.setObject(p),D=p.matrixWorld,f=0,p instanceof THREE.Mesh){if(s instanceof THREE.BufferGeometry){var t=s.attributes,x=s.groups;if(void 0===t.position)continue;for(var y=t.position.array,z=0,A=y.length;z<A;z+=3)K.pushVertex(y[z],y[z+1],y[z+2]);if(void 0!==t.normal)for(var J=t.normal.array,z=0,A=J.length;z<A;z+=3)K.pushNormal(J[z],J[z+1],J[z+2]);if(void 0!==t.uv)for(var S=t.uv.array,z=0,A=S.length;z<A;z+=2)K.pushUv(S[z],S[z+1]);if(null!==s.index){var T=s.index.array;if(x.length>0)for(var l=0;l<x.length;l++)for(var U=x[l],z=U.start,A=U.start+U.count;z<A;z+=3)K.pushTriangle(T[z],T[z+1],T[z+2]);else for(var z=0,A=T.length;z<A;z+=3)K.pushTriangle(T[z],T[z+1],T[z+2])}else for(var z=0,A=y.length/3;z<A;z+=3)K.pushTriangle(z,z+1,z+2)}else if(s instanceof THREE.Geometry){var V=s.vertices,W=s.faces,X=s.faceVertexUvs[0];F.getNormalMatrix(D);for(var Y=p.material,Z=Y instanceof THREE.MultiMaterial,$=Z===!0?p.material:null,_=0,aa=V.length;_<aa;_++){var ba=V[_];if(v.copy(ba),Y.morphTargets===!0)for(var ca=s.morphTargets,da=p.morphTargetInfluences,ea=0,fa=ca.length;ea<fa;ea++){var ga=da[ea];if(0!==ga){var ha=ca[ea],ia=ha.vertices[_];v.x+=(ia.x-ba.x)*ga,v.y+=(ia.y-ba.y)*ga,v.z+=(ia.z-ba.z)*ga}}K.pushVertex(v.x,v.y,v.z)}for(var ja=0,ka=W.length;ja<ka;ja++){var la=W[ja];if(Y=Z===!0?$.materials[la.materialIndex]:p.material,void 0!==Y){var ma=Y.side,na=g[la.a],oa=g[la.b],pa=g[la.c];if(K.checkTriangleVisibility(na,oa,pa)!==!1){var qa=K.checkBackfaceCulling(na,oa,pa);if(ma!==THREE.DoubleSide){if(ma===THREE.FrontSide&&qa===!1)continue;if(ma===THREE.BackSide&&qa===!0)continue}i=N(),i.id=p.id,i.v1.copy(na),i.v2.copy(oa),i.v3.copy(pa),i.normalModel.copy(la.normal),qa!==!1||ma!==THREE.BackSide&&ma!==THREE.DoubleSide||i.normalModel.negate(),i.normalModel.applyMatrix3(F).normalize();for(var ra=la.vertexNormals,sa=0,ta=Math.min(ra.length,3);sa<ta;sa++){var ua=i.vertexNormalsModel[sa];ua.copy(ra[sa]),qa!==!1||ma!==THREE.BackSide&&ma!==THREE.DoubleSide||ua.negate(),ua.applyMatrix3(F).normalize()}i.vertexNormalsLength=ra.length;var va=X[ja];if(void 0!==va)for(var wa=0;wa<3;wa++)i.uvs[wa].copy(va[wa]);i.color=la.color,i.material=Y,i.z=(na.positionScreen.z+oa.positionScreen.z+pa.positionScreen.z)/3,i.renderOrder=p.renderOrder,u.elements.push(i)}}}}}else if(p instanceof THREE.Line){if(s instanceof THREE.BufferGeometry){var t=s.attributes;if(void 0!==t.position){for(var y=t.position.array,z=0,A=y.length;z<A;z+=3)K.pushVertex(y[z],y[z+1],y[z+2]);if(null!==s.index)for(var T=s.index.array,z=0,A=T.length;z<A;z+=2)K.pushLine(T[z],T[z+1]);else for(var xa=p instanceof THREE.LineSegments?2:1,z=0,A=y.length/3-1;z<A;z+=xa)K.pushLine(z,z+1)}}else if(s instanceof THREE.Geometry){E.multiplyMatrices(C,D);var V=p.geometry.vertices;if(0===V.length)continue;na=M(),na.positionScreen.copy(V[0]).applyMatrix4(E);for(var xa=p instanceof THREE.LineSegments?2:1,_=1,aa=V.length;_<aa;_++)na=M(),na.positionScreen.copy(V[_]).applyMatrix4(E),(_+1)%xa>0||(oa=g[f-2],H.copy(na.positionScreen),I.copy(oa.positionScreen),R(H,I)===!0&&(H.multiplyScalar(1/H.w),I.multiplyScalar(1/I.w),m=O(),m.id=p.id,m.v1.positionScreen.copy(H),m.v2.positionScreen.copy(I),m.z=Math.max(H.z,I.z),m.renderOrder=p.renderOrder,m.material=p.material,p.material.vertexColors===THREE.VertexColors&&(m.vertexColors[0].copy(p.geometry.colors[_]),m.vertexColors[1].copy(p.geometry.colors[_-1])),u.elements.push(m)))}}else if(p instanceof THREE.Sprite){w.set(D.elements[12],D.elements[13],D.elements[14],1),w.applyMatrix4(C);var ya=1/w.w;w.z*=ya,w.z>=-1&&w.z<=1&&(q=P(),q.id=p.id,q.x=w.x*ya,q.y=w.y*ya,q.z=w.z,q.renderOrder=p.renderOrder,q.object=p,q.rotation=p.rotation,q.scale.x=p.scale.x*Math.abs(q.x-(w.x+d.projectionMatrix.elements[0])/(w.w+d.projectionMatrix.elements[12])),q.scale.y=p.scale.y*Math.abs(q.y-(w.y+d.projectionMatrix.elements[5])/(w.w+d.projectionMatrix.elements[13])),q.material=p.material,u.elements.push(q))}}return h===!0&&u.elements.sort(Q),u}};
THREE.SpriteCanvasMaterial=function(a){THREE.Material.call(this),this.type="SpriteCanvasMaterial",this.color=new THREE.Color(16777215),this.program=function(a,b){},this.setValues(a)},THREE.SpriteCanvasMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteCanvasMaterial.prototype.constructor=THREE.SpriteCanvasMaterial,THREE.SpriteCanvasMaterial.prototype.clone=function(){var a=new THREE.SpriteCanvasMaterial;return a.copy(this),a.color.copy(this.color),a.program=this.program,a},THREE.CanvasRenderer=function(a){function ta(){ma.setRGB(0,0,0),na.setRGB(0,0,0),oa.setRGB(0,0,0);for(var a=0,b=e.length;a<b;a++){var c=e[a],d=c.color;c instanceof THREE.AmbientLight?ma.add(d):c instanceof THREE.DirectionalLight?na.add(d):c instanceof THREE.PointLight&&oa.add(d)}}function ua(a,b,c){for(var d=0,f=e.length;d<f;d++){var g=e[d];if(_.copy(g.color),g instanceof THREE.DirectionalLight){var h=pa.setFromMatrixPosition(g.matrixWorld).normalize(),i=b.dot(h);if(i<=0)continue;i*=g.intensity,c.add(_.multiplyScalar(i))}else if(g instanceof THREE.PointLight){var h=pa.setFromMatrixPosition(g.matrixWorld),i=b.dot(pa.subVectors(h,a).normalize());if(i<=0)continue;if(i*=0==g.distance?1:1-Math.min(a.distanceTo(h)/g.distance,1),0==i)continue;i*=g.intensity,c.add(_.multiplyScalar(i))}}}function va(a,b,c){Fa(c.opacity),Ga(c.blending);var d=b.scale.x*j,e=b.scale.y*k,f=.5*Math.sqrt(d*d+e*e);if(la.min.set(a.x-f,a.y-f),la.max.set(a.x+f,a.y+f),c instanceof THREE.SpriteMaterial){var g=c.map;if(null!==g){var h=aa[g.id];if(void 0!==h&&h.version===g.version||(h=Ba(g),aa[g.id]=h),void 0!==h.canvas){La(h.canvas);var i=g.image,l=i.width*g.offset.x,m=i.height*g.offset.y,n=i.width*g.repeat.x,o=i.height*g.repeat.y,p=d/n,r=e/o;q.save(),q.translate(a.x,a.y),0!==c.rotation&&q.rotate(c.rotation),q.translate(-d/2,-e/2),q.scale(p,r),q.translate(-l,-m),q.fillRect(l,m,n,o),q.restore()}}else La(c.color.getStyle()),q.save(),q.translate(a.x,a.y),0!==c.rotation&&q.rotate(c.rotation),q.scale(d,-e),q.fillRect(-.5,-.5,1,1),q.restore()}else c instanceof THREE.SpriteCanvasMaterial&&(Ka(c.color.getStyle()),La(c.color.getStyle()),q.save(),q.translate(a.x,a.y),0!==c.rotation&&q.rotate(c.rotation),q.scale(d,e),c.program(q),q.restore())}function wa(a,b,c,d){if(Fa(d.opacity),Ga(d.blending),q.beginPath(),q.moveTo(a.positionScreen.x,a.positionScreen.y),q.lineTo(b.positionScreen.x,b.positionScreen.y),d instanceof THREE.LineBasicMaterial){if(Ha(d.linewidth),Ia(d.linecap),Ja(d.linejoin),d.vertexColors!==THREE.VertexColors)Ka(d.color.getStyle());else{var e=c.vertexColors[0].getStyle(),f=c.vertexColors[1].getStyle();if(e===f)Ka(e);else{try{var g=q.createLinearGradient(a.positionScreen.x,a.positionScreen.y,b.positionScreen.x,b.positionScreen.y);g.addColorStop(0,e),g.addColorStop(1,f)}catch(a){g=e}Ka(g)}}q.stroke(),la.expandByScalar(2*d.linewidth)}else d instanceof THREE.LineDashedMaterial&&(Ha(d.linewidth),Ia(d.linecap),Ja(d.linejoin),Ka(d.color.getStyle()),Ma([d.dashSize,d.gapSize]),q.stroke(),la.expandByScalar(2*d.linewidth),Ma([]))}function xa(a,c,d,e,f,g,h,i){if(b.info.render.vertices+=3,b.info.render.faces++,Fa(i.opacity),Ga(i.blending),I=a.positionScreen.x,J=a.positionScreen.y,K=c.positionScreen.x,L=c.positionScreen.y,M=d.positionScreen.x,N=d.positionScreen.y,ya(I,J,K,L,M,N),(i instanceof THREE.MeshLambertMaterial||i instanceof THREE.MeshPhongMaterial)&&null===i.map)Z.copy(i.color),$.copy(i.emissive),i.vertexColors===THREE.FaceColors&&Z.multiply(h.color),U.copy(ma),qa.copy(a.positionWorld).add(c.positionWorld).add(d.positionWorld).divideScalar(3),ua(qa,h.normalModel,U),U.multiply(Z).add($),i.wireframe===!0?za(U,i.wireframeLinewidth,i.wireframeLinecap,i.wireframeLinejoin):Aa(U);else if(i instanceof THREE.MeshBasicMaterial||i instanceof THREE.MeshLambertMaterial||i instanceof THREE.MeshPhongMaterial)if(null!==i.map){var j=i.map.mapping;j===THREE.UVMapping&&(ca=h.uvs,Ca(I,J,K,L,M,N,ca[e].x,ca[e].y,ca[f].x,ca[f].y,ca[g].x,ca[g].y,i.map))}else null!==i.envMap?i.envMap.mapping===THREE.SphericalReflectionMapping&&(ra.copy(h.vertexNormalsModel[e]).applyMatrix3(sa),da=.5*ra.x+.5,ea=.5*ra.y+.5,ra.copy(h.vertexNormalsModel[f]).applyMatrix3(sa),fa=.5*ra.x+.5,ga=.5*ra.y+.5,ra.copy(h.vertexNormalsModel[g]).applyMatrix3(sa),ha=.5*ra.x+.5,ia=.5*ra.y+.5,Ca(I,J,K,L,M,N,da,ea,fa,ga,ha,ia,i.envMap)):(U.copy(i.color),i.vertexColors===THREE.FaceColors&&U.multiply(h.color),i.wireframe===!0?za(U,i.wireframeLinewidth,i.wireframeLinecap,i.wireframeLinejoin):Aa(U));else i instanceof THREE.MeshNormalMaterial?(ra.copy(h.normalModel).applyMatrix3(sa),U.setRGB(ra.x,ra.y,ra.z).multiplyScalar(.5).addScalar(.5),i.wireframe===!0?za(U,i.wireframeLinewidth,i.wireframeLinecap,i.wireframeLinejoin):Aa(U)):(U.setRGB(1,1,1),i.wireframe===!0?za(U,i.wireframeLinewidth,i.wireframeLinecap,i.wireframeLinejoin):Aa(U))}function ya(a,b,c,d,e,f){q.beginPath(),q.moveTo(a,b),q.lineTo(c,d),q.lineTo(e,f),q.closePath()}function za(a,b,c,d){Ha(b),Ia(c),Ja(d),Ka(a.getStyle()),q.stroke(),la.expandByScalar(2*b)}function Aa(a){La(a.getStyle()),q.fill()}function Ba(a){if(0===a.version||a instanceof THREE.CompressedTexture||a instanceof THREE.DataTexture)return{canvas:void 0,version:a.version};var b=a.image;if(b.complete===!1)return{canvas:void 0,version:0};var c=document.createElement("canvas");c.width=b.width,c.height=b.height;var d=c.getContext("2d");d.setTransform(1,0,0,-1,0,b.height),d.drawImage(b,0,0);var e=a.wrapS===THREE.RepeatWrapping,f=a.wrapT===THREE.RepeatWrapping,g="no-repeat";e===!0&&f===!0?g="repeat":e===!0?g="repeat-x":f===!0&&(g="repeat-y");var h=q.createPattern(c,g);return a.onUpdate&&a.onUpdate(a),{canvas:h,version:a.version}}function Ca(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=aa[m.id];if(void 0!==n&&n.version===m.version||(n=Ba(m),aa[m.id]=n),void 0===n.canvas)return La("rgba( 0, 0, 0, 1)"),void q.fill();La(n.canvas);var o,p,r,s,t,u,v,w,x=m.offset.x/m.repeat.x,y=m.offset.y/m.repeat.y,z=m.image.width*m.repeat.x,A=m.image.height*m.repeat.y;g=(g+x)*z,h=(h+y)*A,i=(i+x)*z,j=(j+y)*A,k=(k+x)*z,l=(l+y)*A,c-=a,d-=b,e-=a,f-=b,i-=g,j-=h,k-=g,l-=h,v=i*l-k*j,0!==v&&(w=1/v,o=(l*c-j*e)*w,p=(l*d-j*f)*w,r=(i*e-k*c)*w,s=(i*f-k*d)*w,t=a-o*g-r*h,u=b-p*g-s*h,q.save(),q.transform(o,p,r,s,t,u),q.fill(),q.restore())}function Ea(a,b,c){var g,d=b.x-a.x,e=b.y-a.y,f=d*d+e*e;0!==f&&(g=c/Math.sqrt(f),d*=g,e*=g,b.x+=d,b.y+=e,a.x-=d,a.y-=e)}function Fa(a){t!==a&&(q.globalAlpha=a,t=a)}function Ga(a){u!==a&&(a===THREE.NormalBlending?q.globalCompositeOperation="source-over":a===THREE.AdditiveBlending?q.globalCompositeOperation="lighter":a===THREE.SubtractiveBlending?q.globalCompositeOperation="darker":a===THREE.MultiplyBlending&&(q.globalCompositeOperation="multiply"),u=a)}function Ha(a){x!==a&&(q.lineWidth=a,x=a)}function Ia(a){y!==a&&(q.lineCap=a,y=a)}function Ja(a){z!==a&&(q.lineJoin=a,z=a)}function Ka(a){v!==a&&(q.strokeStyle=a,v=a)}function La(a){w!==a&&(q.fillStyle=a,w=a)}function Ma(a){A.length!==a.length&&(q.setLineDash(a),A=a)}console.log("THREE.CanvasRenderer",THREE.REVISION),a=a||{};var c,d,e,B,C,D,E,I,J,K,L,M,N,ca,da,ea,fa,ga,ha,ia,b=this,f=new THREE.Projector,g=void 0!==a.canvas?a.canvas:document.createElement("canvas"),h=g.width,i=g.height,j=Math.floor(h/2),k=Math.floor(i/2),l=0,m=0,n=h,o=i,p=1,q=g.getContext("2d",{alpha:a.alpha===!0}),r=new THREE.Color(0),s=a.alpha===!0?0:1,t=1,u=0,v=null,w=null,x=null,y=null,z=null,A=[],U=(new THREE.RenderableVertex,new THREE.RenderableVertex,new THREE.Color),Z=(new THREE.Color,new THREE.Color,new THREE.Color,new THREE.Color,new THREE.Color),$=new THREE.Color,_=new THREE.Color,aa={},ja=new THREE.Box2,ka=new THREE.Box2,la=new THREE.Box2,ma=new THREE.Color,na=new THREE.Color,oa=new THREE.Color,pa=new THREE.Vector3,qa=new THREE.Vector3,ra=new THREE.Vector3,sa=new THREE.Matrix3;void 0===q.setLineDash&&(q.setLineDash=function(){}),this.domElement=g,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.info={render:{vertices:0,faces:0}},this.supportsVertexTextures=function(){},this.setFaceCulling=function(){},this.getContext=function(){return q},this.getContextAttributes=function(){return q.getContextAttributes()},this.getPixelRatio=function(){return p},this.setPixelRatio=function(a){void 0!==a&&(p=a)},this.setSize=function(a,b,c){h=a*p,i=b*p,g.width=h,g.height=i,j=Math.floor(h/2),k=Math.floor(i/2),c!==!1&&(g.style.width=a+"px",g.style.height=b+"px"),ja.min.set(-j,-k),ja.max.set(j,k),ka.min.set(-j,-k),ka.max.set(j,k),t=1,u=0,v=null,w=null,x=null,y=null,z=null,this.setViewport(0,0,a,b)},this.setViewport=function(a,b,c,d){l=a*p,m=b*p,n=c*p,o=d*p},this.setScissor=function(){},this.setScissorTest=function(){},this.setClearColor=function(a,b){r.set(a),s=void 0!==b?b:1,ka.min.set(-j,-k),ka.max.set(j,k)},this.setClearColorHex=function(a,b){console.warn("THREE.CanvasRenderer: .setClearColorHex() is being removed. Use .setClearColor() instead."),this.setClearColor(a,b)},this.getClearColor=function(){return r},this.getClearAlpha=function(){return s},this.getMaxAnisotropy=function(){return 0},this.clear=function(){ka.isEmpty()===!1&&(ka.intersect(ja),ka.expandByScalar(2),ka.min.x=ka.min.x+j,ka.min.y=-ka.min.y+k,ka.max.x=ka.max.x+j,ka.max.y=-ka.max.y+k,s<1&&q.clearRect(0|ka.min.x,0|ka.max.y,ka.max.x-ka.min.x|0,ka.min.y-ka.max.y|0),s>0&&(Ga(THREE.NormalBlending),Fa(1),La("rgba("+Math.floor(255*r.r)+","+Math.floor(255*r.g)+","+Math.floor(255*r.b)+","+s+")"),q.fillRect(0|ka.min.x,0|ka.max.y,ka.max.x-ka.min.x|0,ka.min.y-ka.max.y|0)),ka.makeEmpty())},this.clearColor=function(){},this.clearDepth=function(){},this.clearStencil=function(){},this.render=function(a,g){if(g instanceof THREE.Camera==!1)return void console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");this.autoClear===!0&&this.clear(),b.info.render.vertices=0,b.info.render.faces=0,q.setTransform(n/h,0,0,-o/i,l,i-m),q.translate(j,k),c=f.projectScene(a,g,this.sortObjects,this.sortElements),d=c.elements,e=c.lights,B=g,sa.getNormalMatrix(g.matrixWorldInverse),ta();for(var p=0,r=d.length;p<r;p++){var s=d[p],t=s.material;if(void 0!==t&&0!==t.opacity){if(la.makeEmpty(),s instanceof THREE.RenderableSprite)C=s,C.x*=j,C.y*=k,va(C,s,t);else if(s instanceof THREE.RenderableLine)C=s.v1,D=s.v2,C.positionScreen.x*=j,C.positionScreen.y*=k,D.positionScreen.x*=j,D.positionScreen.y*=k,la.setFromPoints([C.positionScreen,D.positionScreen]),ja.intersectsBox(la)===!0&&wa(C,D,s,t);else if(s instanceof THREE.RenderableFace){if(C=s.v1,D=s.v2,E=s.v3,C.positionScreen.z<-1||C.positionScreen.z>1)continue;if(D.positionScreen.z<-1||D.positionScreen.z>1)continue;if(E.positionScreen.z<-1||E.positionScreen.z>1)continue;C.positionScreen.x*=j,C.positionScreen.y*=k,D.positionScreen.x*=j,D.positionScreen.y*=k,E.positionScreen.x*=j,E.positionScreen.y*=k,t.overdraw>0&&(Ea(C.positionScreen,D.positionScreen,t.overdraw),Ea(D.positionScreen,E.positionScreen,t.overdraw),Ea(E.positionScreen,C.positionScreen,t.overdraw)),la.setFromPoints([C.positionScreen,D.positionScreen,E.positionScreen]),ja.intersectsBox(la)===!0&&xa(C,D,E,0,1,2,s,t)}ka.union(la)}}q.setTransform(1,0,0,1,0,0)}};var Bird=function(){function b(b,c,d){a.vertices.push(new THREE.Vector3(b,c,d))}function c(b,c,d){a.faces.push(new THREE.Face3(b,c,d))}var a=this;THREE.Geometry.call(this),b(5,0,0),b(-5,-2,1),b(-5,0,0),b(-5,-2,-1),b(0,2,-6),b(0,2,6),b(2,0,0),b(-3,0,0),c(0,2,1),c(4,7,6),c(5,6,7),this.computeFaceNormals()};Bird.prototype=Object.create(THREE.Geometry.prototype),Bird.prototype.constructor=Bird;